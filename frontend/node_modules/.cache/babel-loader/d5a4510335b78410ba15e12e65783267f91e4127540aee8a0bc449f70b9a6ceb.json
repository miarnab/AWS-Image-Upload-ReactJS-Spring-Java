{"ast":null,"code":"import React,{useState}from'react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const ImageUpload=()=>{const[selectedFile,setSelectedFile]=useState(null);const[profiles,setProfiles]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState('');// Fetch profiles on component mount\nReact.useEffect(()=>{fetchProfiles();},[]);const fetchProfiles=async()=>{try{const response=await axios.get('/api/v1/user-profile');setProfiles(response.data);}catch(err){setError('Failed to fetch profiles');console.error('Error fetching profiles:',err);}};const handleFileSelect=event=>{var _event$target$files;const file=(_event$target$files=event.target.files)===null||_event$target$files===void 0?void 0:_event$target$files[0];if(file){setSelectedFile(file);setError('');}};const handleSubmit=async event=>{event.preventDefault();if(!selectedFile){setError('Please select a file');return;}setLoading(true);setError('');try{var _profiles$;const formData=new FormData();formData.append('file',selectedFile);// Assuming we're uploading to the first user's profile\n// In a real app, you'd want to specify the user\nconst userProfileId=(_profiles$=profiles[0])===null||_profiles$===void 0?void 0:_profiles$.userProfileId;if(!userProfileId){throw new Error('No user profile available');}await axios.post(\"/api/v1/user-profile/\".concat(userProfileId,\"/image/upload\"),formData,{headers:{'Content-Type':'multipart/form-data'}});// Refresh profiles to show new image\nawait fetchProfiles();setSelectedFile(null);// Reset file input\nconst fileInput=document.querySelector('input[type=\"file\"]');if(fileInput)fileInput.value='';}catch(err){setError('Failed to upload image');console.error('Error uploading file:',err);}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px',maxWidth:'600px',margin:'0 auto'},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Profile Image Upload\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:'20px'},children:/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handleFileSelect,disabled:loading})}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:!selectedFile||loading,style:{padding:'8px 16px',backgroundColor:!selectedFile||loading?'#ccc':'#0066cc',color:'white',border:'none',borderRadius:'4px',cursor:!selectedFile||loading?'not-allowed':'pointer'},children:loading?'Uploading...':'Upload'}),error&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red',marginTop:'10px'},children:error})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'40px'},children:[/*#__PURE__*/_jsx(\"h3\",{children:\"User Profiles\"}),profiles.map(profile=>/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px',padding:'10px',border:'1px solid #ddd',borderRadius:'4px'},children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Username:\"}),\" \",profile.username]}),profile.userProfileImageLink&&/*#__PURE__*/_jsx(\"img\",{src:profile.userProfileImageLink,alt:\"\".concat(profile.username,\"'s profile\"),style:{maxWidth:'200px',marginTop:'10px'}})]},profile.userProfileId))]})]});};","map":{"version":3,"names":["React","useState","axios","jsx","_jsx","jsxs","_jsxs","ImageUpload","selectedFile","setSelectedFile","profiles","setProfiles","loading","setLoading","error","setError","useEffect","fetchProfiles","response","get","data","err","console","handleFileSelect","event","_event$target$files","file","target","files","handleSubmit","preventDefault","_profiles$","formData","FormData","append","userProfileId","Error","post","concat","headers","fileInput","document","querySelector","value","style","padding","maxWidth","margin","children","onSubmit","marginBottom","type","accept","onChange","disabled","backgroundColor","color","border","borderRadius","cursor","marginTop","map","profile","username","userProfileImageLink","src","alt"],"sources":["C:/Users/mitra/Desktop/AWS-Image-Upload-ReactJS-Spring-Java/frontend/src/components/ImageUpload.tsx"],"sourcesContent":["import React, { useState, ChangeEvent, FormEvent } from 'react';\r\nimport axios from 'axios';\r\n\r\ninterface UserProfile {\r\n  userProfileId: string;\r\n  username: string;\r\n  userProfileImageLink: string;\r\n}\r\n\r\nexport const ImageUpload: React.FC = () => {\r\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\r\n  const [profiles, setProfiles] = useState<UserProfile[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string>('');\r\n\r\n  // Fetch profiles on component mount\r\n  React.useEffect(() => {\r\n    fetchProfiles();\r\n  }, []);\r\n\r\n  const fetchProfiles = async () => {\r\n    try {\r\n      const response = await axios.get<UserProfile[]>('/api/v1/user-profile');\r\n      setProfiles(response.data);\r\n    } catch (err) {\r\n      setError('Failed to fetch profiles');\r\n      console.error('Error fetching profiles:', err);\r\n    }\r\n  };\r\n\r\n  const handleFileSelect = (event: ChangeEvent<HTMLInputElement>) => {\r\n    const file = event.target.files?.[0];\r\n    if (file) {\r\n      setSelectedFile(file);\r\n      setError('');\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (event: FormEvent) => {\r\n    event.preventDefault();\r\n    if (!selectedFile) {\r\n      setError('Please select a file');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setError('');\r\n\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('file', selectedFile);\r\n\r\n      // Assuming we're uploading to the first user's profile\r\n      // In a real app, you'd want to specify the user\r\n      const userProfileId = profiles[0]?.userProfileId;\r\n      \r\n      if (!userProfileId) {\r\n        throw new Error('No user profile available');\r\n      }\r\n\r\n      await axios.post(\r\n        `/api/v1/user-profile/${userProfileId}/image/upload`,\r\n        formData,\r\n        {\r\n          headers: {\r\n            'Content-Type': 'multipart/form-data',\r\n          },\r\n        }\r\n      );\r\n\r\n      // Refresh profiles to show new image\r\n      await fetchProfiles();\r\n      setSelectedFile(null);\r\n      \r\n      // Reset file input\r\n      const fileInput = document.querySelector('input[type=\"file\"]') as HTMLInputElement;\r\n      if (fileInput) fileInput.value = '';\r\n    } catch (err) {\r\n      setError('Failed to upload image');\r\n      console.error('Error uploading file:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={{ padding: '20px', maxWidth: '600px', margin: '0 auto' }}>\r\n      <h2>Profile Image Upload</h2>\r\n      \r\n      <form onSubmit={handleSubmit}>\r\n        <div style={{ marginBottom: '20px' }}>\r\n          <input\r\n            type=\"file\"\r\n            accept=\"image/*\"\r\n            onChange={handleFileSelect}\r\n            disabled={loading}\r\n          />\r\n        </div>\r\n        \r\n        <button\r\n          type=\"submit\"\r\n          disabled={!selectedFile || loading}\r\n          style={{\r\n            padding: '8px 16px',\r\n            backgroundColor: !selectedFile || loading ? '#ccc' : '#0066cc',\r\n            color: 'white',\r\n            border: 'none',\r\n            borderRadius: '4px',\r\n            cursor: !selectedFile || loading ? 'not-allowed' : 'pointer'\r\n          }}\r\n        >\r\n          {loading ? 'Uploading...' : 'Upload'}\r\n        </button>\r\n\r\n        {error && (\r\n          <p style={{ color: 'red', marginTop: '10px' }}>{error}</p>\r\n        )}\r\n      </form>\r\n\r\n      <div style={{ marginTop: '40px' }}>\r\n        <h3>User Profiles</h3>\r\n        {profiles.map(profile => (\r\n          <div\r\n            key={profile.userProfileId}\r\n            style={{\r\n              marginBottom: '20px',\r\n              padding: '10px',\r\n              border: '1px solid #ddd',\r\n              borderRadius: '4px'\r\n            }}\r\n          >\r\n            <p><strong>Username:</strong> {profile.username}</p>\r\n            {profile.userProfileImageLink && (\r\n              <img\r\n                src={profile.userProfileImageLink}\r\n                alt={`${profile.username}'s profile`}\r\n                style={{\r\n                  maxWidth: '200px',\r\n                  marginTop: '10px'\r\n                }}\r\n              />\r\n            )}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}